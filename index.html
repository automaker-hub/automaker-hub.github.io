<!DOCTYPE html>
<html lang="ja">
<head>

  <!-- Ezoic Privacy Scripts -->
  <script data-cfasync="false" src="https://cmp.gatekeeperconsent.com/min.js"></script>
  <script data-cfasync="false" src="https://the.gatekeeperconsent.com/cmp.min.js"></script>

  <!-- Ezoic Header Script -->
  <script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
  <script>
    window.ezstandalone = window.ezstandalone || {};
    ezstandalone.cmd = ezstandalone.cmd || [];
  </script>
  
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gmail æ•´ç†ãƒ„ãƒ¼ãƒ« â€“ Mail Cleaner Lab | automaker-hub</title>

  <!-- â˜… SEO åŸºæœ¬ã‚¿ã‚° -->
  <meta name="description" content="Gmail ã®ä¸è¦ãƒ¡ãƒ¼ãƒ«ã‚’ä¸€æ°—ã«æ•´ç†ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚æ¤œç´¢æ¡ä»¶ã‚’è‡ªå‹•ç”Ÿæˆã—ã¦ã€å‰Šé™¤ãƒ»æ—¢èª­åŒ–ãƒ»å‰Šé™¤ã›ãšå—ä¿¡ãƒˆãƒ¬ã‚¤ã‹ã‚‰éè¡¨ç¤ºã«ã™ã‚‹ï¼ˆå‰Šé™¤ã•ã‚Œã¾ã›ã‚“ï¼‰ã¾ã§ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å®Ÿè¡Œã§ãã¾ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã ã‘ã§å®Œçµã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ã€‚">
  <meta name="keywords" content="Gmail æ•´ç†, Gmail ä¸€æ‹¬å‰Šé™¤, ãƒ¡ãƒ¼ãƒ« æ•´ç† ãƒ„ãƒ¼ãƒ«, è¿·æƒ‘ãƒ¡ãƒ¼ãƒ« å‰Šé™¤, ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ ç‰‡ä»˜ã‘">

  <!-- â˜… ã‚«ãƒãƒ‹ã‚«ãƒ«ï¼ˆæ­£è¦ URLï¼‰ -->
  <link rel="canonical" href="https://automaker-hub.github.io/">

  <!-- â˜… OGP -->
  <meta property="og:title" content="Gmail æ•´ç†ãƒ„ãƒ¼ãƒ« â€“ Mail Cleaner Lab" />
  <meta property="og:description" content="Gmail ã®ä¸è¦ãƒ¡ãƒ¼ãƒ«ã‚’ä¸€æ‹¬æ•´ç†ã€‚æ¤œç´¢æ¡ä»¶ã‚’è‡ªå‹•ç”Ÿæˆã—ã€å‰Šé™¤ãƒ»æ—¢èª­åŒ–ãƒ»å‰Šé™¤ã›ãšå—ä¿¡ãƒˆãƒ¬ã‚¤ã‹ã‚‰éè¡¨ç¤ºã«ã™ã‚‹ï¼ˆå‰Šé™¤ã•ã‚Œã¾ã›ã‚“ï¼‰ã¾ã§ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å®Ÿè¡Œã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://automaker-hub.github.io/" />
  <meta property="og:image" content="https://automaker-hub.github.io/ogp.png" />
  <meta property="og:site_name" content="Mail Cleaner Lab" />
  <meta property="og:locale" content="ja_JP" />

  <!-- â˜… Twitter ã‚«ãƒ¼ãƒ‰ -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Gmail æ•´ç†ãƒ„ãƒ¼ãƒ« â€“ Mail Cleaner Lab" />
  <meta name="twitter:description" content="Gmail ã®ä¸è¦ãƒ¡ãƒ¼ãƒ«ã‚’ä¸€æ‹¬æ•´ç†ã€‚æ¤œç´¢æ¡ä»¶ã‚’è‡ªå‹•ç”Ÿæˆã—ã€å‰Šé™¤ãƒ»æ—¢èª­åŒ–ãƒ»å‰Šé™¤ã›ãšå—ä¿¡ãƒˆãƒ¬ã‚¤ã‹ã‚‰éè¡¨ç¤ºã«ã™ã‚‹ï¼ˆå‰Šé™¤ã•ã‚Œã¾ã›ã‚“ï¼‰ã¾ã§ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å®Ÿè¡Œã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚" />
  <meta name="twitter:image" content="https://automaker-hub.github.io/ogp.png" />

  <!-- â˜… æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆJSON-LDï¼‰ -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Gmail æ•´ç†ãƒ„ãƒ¼ãƒ« â€“ Mail Cleaner Lab",
    "url": "https://automaker-hub.github.io/",
    "applicationCategory": "Utility",
    "description": "Gmail ã®ä¸è¦ãƒ¡ãƒ¼ãƒ«ã‚’ä¸€æ‹¬æ•´ç†ã€‚æ¤œç´¢æ¡ä»¶ã®è‡ªå‹•ç”Ÿæˆã¨ã€å‰Šé™¤ãƒ»æ—¢èª­åŒ–ãƒ»å‰Šé™¤ã›ãšå—ä¿¡ãƒˆãƒ¬ã‚¤ã‹ã‚‰éè¡¨ç¤ºã«ã™ã‚‹ï¼ˆå‰Šé™¤ã•ã‚Œã¾ã›ã‚“ï¼‰ã‚’ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å®Ÿè¡Œã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚",
    "operatingSystem": "All",
    "author": {
      "@type": "Person",
      "name": "automaker-hub"
    }
  }
  </script>

  <!-- AdSenseï¼ˆãã®ã¾ã¾ã§ OKï¼‰ -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2398505946967311"
    crossorigin="anonymous"></script>

  <style>
    /* ===================== */
    /*   Googleå…¬å¼ã£ã½ã„åŸºæœ¬ãƒ†ãƒ¼ãƒ  */
    /* ===================== */
    :root {
      --bg: #f5f5f5;
      --card-bg: #ffffff;
      --accent: #1a73e8;       /* Googleãƒ–ãƒ«ãƒ¼ */
      --accent-soft: #e8f0fe;
      --border: #e0e0e0;
      --text-main: #202124;
      --text-sub: #5f6368;
      --danger: #d93025;
      --danger-soft: #fce8e6;
      --shadow-soft: 0 1px 3px rgba(60,64,67,0.25);
      --radius-lg: 12px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text-main);
      min-height: 100vh;
    }

    .page {
      max-width: 1120px;
      margin: 0 auto;
      padding: 16px 16px 32px;
    }

    /* ===================== */
    /*   ãƒ˜ãƒƒãƒ€ãƒ¼             */
    /* ===================== */
    header {
      padding: 8px 0 12px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 12px;
      background: #ffffff;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .headline {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
    }

    .headline-left {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .app-title-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .app-icon-circle {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #e8f0fe;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent);
      font-size: 18px;
    }

    .app-title {
      margin: 0;
      font-size: 1.4rem;
      font-weight: 600;
      letter-spacing: 0.01em;
      color: #202124;
    }

    .app-subtitle {
      margin: 0;
      font-size: 0.86rem;
      color: var(--text-sub);
      line-height: 1.6;
    }

    .headline-right {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    /* å•ã„åˆã‚ã›ãƒœã‚¿ãƒ³ */
    .btn-contact {
      padding: 8px 14px;
      background: #ffffff;
      border: 1px solid var(--border);
      border-radius: 999px;
      color: var(--text-main);
      font-size: 0.82rem;
      text-decoration: none;
      transition: 0.15s;
      display: inline-flex;
      align-items: center;
      white-space: nowrap;
    }

    .btn-contact:hover {
      background: #f8f9fa;
      border-color: #dadce0;
    }

    /* OAuth ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ */
    .auth-area {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .btn-auth {
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid transparent;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.85rem;
      font-weight: 500;
      background: var(--accent);
      color: #ffffff;
      box-shadow: 0 1px 3px rgba(60,64,67,0.3);
    }

    .btn-auth.secondary {
      background: #ffffff;
      border: 1px solid #dadce0;
      color: var(--text-main);
      box-shadow: none;
    }

    .btn-auth .icon {
      font-size: 1.05rem;
    }

    .pill-mini {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.7rem;
      border: 1px solid #dadce0;
      color: var(--text-sub);
      white-space: nowrap;
      background: #ffffff;
    }

    .pill-mini .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #dadce0;
      transition: background 0.15s, box-shadow 0.15s;
    }

    .pill-mini .dot.on {
      background: #1e8e3e;
      box-shadow: 0 0 4px rgba(27, 128, 58, 0.9);
    }

    .pill-mini .dot.off {
      background: #f9ab00;
      box-shadow: none;
    }

    /* ===================== */
    /*   ãƒ¡ã‚¤ãƒ³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ     */
    /* ===================== */
    .layout {
      display: flex;
      gap: 16px;
      margin-top: 12px;
      align-items: flex-start;
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border);
      box-shadow: var(--shadow-soft);
      padding: 16px 18px;
      flex: 1;
      min-width: 0;
    }

    .card h2 {
      margin-top: 0;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 600;
      color: #202124;
    }

    .card h2 .dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent);
    }

    .card .desc {
      margin: 6px 0 14px;
      font-size: 0.8rem;
      color: var(--text-sub);
      line-height: 1.6;
    }

    .section-label {
      font-size: 0.8rem;
      font-weight: 600;
      margin: 10px 0 4px;
      color: var(--text-sub);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .section-label .bar {
      display: inline-block;
      width: 3px;
      height: 16px;
      border-radius: 999px;
      background: var(--accent);
      opacity: 0.75;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 4px;
      border: 1px solid #dadce0;
      background: #ffffff;
      color: var(--text-main);
      font-size: 0.85rem;
      outline: none;
      transition: border 0.15s, box-shadow 0.15s, background 0.15s;
      font-family: inherit;
    }

    input::placeholder,
    textarea::placeholder {
      color: #9aa0a6;
    }

    input:focus,
    textarea:focus,
    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent-soft);
      background: #ffffff;
    }

    textarea {
      resize: vertical;
      min-height: 70px;
    }

    .row-two {
      display: flex;
      gap: 8px;
    }

    .row-two > div {
      flex: 1;
    }

    .preset {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 6px;
    }

    .preset button {
      border-radius: 999px;
      border: 1px solid #dadce0;
      background: #ffffff;
      color: #3c4043;
      font-size: 0.75rem;
      padding: 5px 12px;
      cursor: pointer;
      transition: background 0.15s, color 0.15s, border 0.15s, box-shadow 0.15s;
    }

    .preset button:hover {
      background: #f1f3f4;
      border-color: #d2e3fc;
      box-shadow: 0 1px 2px rgba(60,64,67,0.2);
    }

    .preset button.active {
      background: #e8f0fe;
      border-color: var(--accent);
      color: var(--accent);
    }

    .preset-note {
      font-size: 0.72rem;
      color: var(--text-sub);
      margin-bottom: 4px;
    }

    .button-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    .btn-main,
    .btn-secondary,
    .btn-danger,
    .btn-ghost {
      flex: 1;
      min-width: 120px;
      border-radius: 4px;
      padding: 8px 10px;
      font-size: 0.86rem;
      font-weight: 500;
      border: 1px solid transparent;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: background 0.15s, box-shadow 0.15s, opacity 0.15s;
      white-space: nowrap;
    }

    .btn-main {
      background: var(--accent);
      color: #ffffff;
      box-shadow: 0 1px 3px rgba(60,64,67,0.3);
    }

    .btn-secondary {
      background: #ffffff;
      border-color: #dadce0;
      color: #3c4043;
    }

    .btn-danger {
      background: var(--danger);
      color: #ffffff;
      box-shadow: 0 1px 3px rgba(60,64,67,0.3);
    }

    .btn-ghost {
      background: #ffffff;
      border: 1px dashed #dadce0;
      color: var(--text-sub);
    }

    .btn-main:hover,
    .btn-secondary:hover,
    .btn-danger:hover,
    .btn-ghost:hover {
      box-shadow: 0 1px 4px rgba(60,64,67,0.3);
      opacity: 0.95;
    }

    .btn-main .icon,
    .btn-secondary .icon,
    .btn-danger .icon {
      font-size: 1rem;
    }

    select {
      background-image: linear-gradient(45deg, transparent 50%, #9aa0a6 50%),
                        linear-gradient(135deg, #9aa0a6 50%, transparent 50%);
      background-position: calc(100% - 14px) 50%, calc(100% - 9px) 50%;
      background-size: 5px 5px, 5px 5px;
      background-repeat: no-repeat;
      appearance: none;
    }

    .result-block {
      background: #f8f9fa;
      border-radius: 8px;
      border: 1px solid #dadce0;
      padding: 10px 12px;
      margin-bottom: 10px;
    }

    .result-block.danger {
      background: var(--danger-soft);
      border-color: #f28b82;
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }

    .result-header .title {
      font-size: 0.8rem;
      font-weight: 600;
      color: #3c4043;
    }

    .result-header .counter {
      font-size: 0.75rem;
      color: var(--text-sub);
    }

    .ad-slot {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px dashed #dadce0;
      background: #f8f9fa;
      font-size: 0.78rem;
      color: var(--text-sub);
    }

    .ad-slot strong {
      color: #1a73e8;
    }

    footer {
      margin-top: 16px;
      font-size: 0.7rem;
      color: var(--text-sub);
      text-align: right;
    }

    /* ã‚¹ãƒãƒ›å¯¾å¿œ */
    @media (max-width: 768px) {
      header {
        position: static;
      }

      .page {
        padding: 10px 10px 24px;
      }

      .headline {
        align-items: flex-start;
      }

      .app-title {
        font-size: 1.2rem;
      }

      .app-subtitle {
        font-size: 0.78rem;
      }

      .headline-right {
        width: 100%;
        justify-content: flex-start;
      }

      .auth-area {
        flex-direction: column;
        align-items: flex-start;
      }

      .layout {
        flex-direction: column;
      }

      .card {
        padding: 14px 14px 16px;
      }

      .button-row {
        flex-direction: column;
      }

      .btn-main,
      .btn-secondary,
      .btn-danger,
      .btn-ghost {
        width: 100%;
      }
    }
  </style>

<script>
(function() {
  const ua = navigator.userAgent.toLowerCase();

  // LINE, Instagram, Facebook ã®ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶åˆ¤å®š
  const isLine = ua.indexOf("line") !== -1;
  const isInstagram = ua.indexOf("instagram") !== -1;
  const isFacebook = ua.indexOf("fbav") !== -1;

  if (isLine || isInstagram || isFacebook) {
    // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤º
    alert("ã“ã®ãƒ„ãƒ¼ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹ã«ã¯ã€Safari ã¾ãŸã¯ Chrome ã§é–‹ã„ã¦ãã ã•ã„ã€‚\n\nOKã‚’æŠ¼ã™ã¨è‡ªå‹•ã§ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ãã¾ã™ã€‚");

    // iPhone â†’ Safari ã§é–‹ã
    if (/iphone|ipad|ipod/.test(ua)) {
      window.location.href = "googlechrome://automaker-hub.github.io/";
      setTimeout(() => {
        window.location.href = "https://automaker-hub.github.io/";
      }, 800);
    } 
    // Android â†’ Chrome ã§é–‹ã
    else if (/android/.test(ua)) {
      window.location.href = "googlechrome://automaker-hub.github.io/";
      setTimeout(() => {
        window.location.href = "https://automaker-hub.github.io/";
      }, 800);
    }
  }
})();
</script>


  <!-- â˜… PWAï¼šmanifest -->
<link rel="manifest" href="/manifest.json">

<!-- iOS ã®ãƒ›ãƒ¼ãƒ è¿½åŠ å¯¾å¿œ -->
<link rel="apple-touch-icon" href="/icons/icon-192.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<!-- PWAï¼šService Worker ç™»éŒ² -->
<script>
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      navigator.serviceWorker.register("/sw.js").catch(err => {
        console.log("SW registration failed:", err);
      });
    });
  }
</script>

  <script async src="//www.ezojs.com/ezoic/sa.min.js"></script>
 <script src="https://static.ezoic.com/j/mailcleanerlab.com/integration.js" defer></script>
  
</head>
<body>
  <div class="page">
    <header>
      <div class="headline">
        <div class="headline-left">
          <div class="app-title-row">
            <div class="app-icon-circle">âœ‰ï¸</div>
            <h1 class="app-title">Gmail æ•´ç†ãƒ„ãƒ¼ãƒ«</h1>
          </div>
          <p class="app-subtitle">
            ã„ã‚‰ãªã„ãƒ¡ãƒ¼ãƒ«ã‚’ã¾ã¨ã‚ã¦æ•´ç†ã§ãã¾ã™ã€‚æ¤œç´¢æ¡ä»¶ã‚’è‡ªå‹•ã§ä½œã‚Šã€å‰Šé™¤ãƒ»æ—¢èª­ã«ã™ã‚‹ãƒ»å‰Šé™¤ã›ãšå—ä¿¡ãƒˆãƒ¬ã‚¤ã‹ã‚‰éè¡¨ç¤ºã«ã™ã‚‹ï¼ˆå‰Šé™¤ã•ã‚Œã¾ã›ã‚“ï¼‰ã‚’ä¸€åº¦ã«å®Ÿè¡Œã—ã¾ã™ã€‚
          </p>
        </div>
        <div class="headline-right">
  <a href="contact.html" class="btn-contact">ãŠå•ã„åˆã‚ã›</a>

  <!-- â˜… è¿½åŠ ï¼šãƒ–ãƒ­ã‚°ï¼ˆå¯©æŸ»ç”¨è¨˜äº‹ï¼‰ã¸ã®ãƒªãƒ³ã‚¯ -->
  <a href="/blog/adsense-article.html" class="btn-contact">ãƒ¡ãƒ¼ãƒ«æ•´ç†ã®ã‚³ãƒ„</a>
</div>
      </div>

      <!-- OAuth ãƒœã‚¿ãƒ³ -->
      <div class="auth-area">
        <button id="oauth-btn" class="btn-auth">
          <span class="icon">ğŸ”</span>
          Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨é€£æºã™ã‚‹
        </button>
        <button id="btn-signout" class="btn-auth secondary">
          <span class="icon">ğŸšª</span>
          é€£æºã‚’è§£é™¤ã™ã‚‹
        </button>
        <span class="pill-mini" id="auth-status">
          <span class="dot off" id="auth-dot"></span> ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: æœªé€£æº
        </span>
      </div>
    </header>
<main>
  <div class="layout">

    <!-- ============================= -->
    <!-- å·¦ã‚«ãƒ©ãƒ ï¼šæ¤œç´¢æ¡ä»¶ãƒ•ã‚©ãƒ¼ãƒ  -->
    <!-- ============================= -->
    <section class="card" aria-label="æ¤œç´¢æ¡ä»¶ãƒ•ã‚©ãƒ¼ãƒ ">

      <h2 class="section-title">
        <span class="dot"></span>
        æ¤œç´¢æ¡ä»¶ã®ä½œæˆ
      </h2>

      <p class="desc">
        é€ä¿¡å…ƒãƒ»ä»¶åãƒ»æœ¬æ–‡ãªã©ã‚’çµ„ã¿åˆã‚ã›ã¦ Gmail ã®æ¤œç´¢æ¡ä»¶ã‚’ä½œæˆã§ãã¾ã™ã€‚
        ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰ã€Œã‹ã‚“ãŸã‚“æ¡ä»¶ã€ã‚‚åˆ©ç”¨ã§ãã¾ã™ã€‚
      </p>

      <!-- ã‹ã‚“ãŸã‚“æ¡ä»¶ -->
      <div class="section-label"><span class="bar"></span>ã‹ã‚“ãŸã‚“æ¡ä»¶ï¼ˆãƒ¯ãƒ³ã‚¿ãƒƒãƒ—ï¼‰</div>
      <div class="preset">
        <button data-preset="rakuten">æ¥½å¤©ãƒ¡ãƒ¼ãƒ«</button>
        <button data-preset="amazon">Amazoné€šçŸ¥</button>
        <button data-preset="promo">åºƒå‘Šãƒ¡ãƒ¼ãƒ«</button>
        <button data-preset="magazine">ãƒ¡ãƒ«ãƒã‚¬</button>
        <button data-preset="old-promo">å¤ã„åºƒå‘Šï¼ˆ30æ—¥ä»¥ä¸Šå‰ï¼‰</button>
      </div>

      <!-- é€ä¿¡å…ƒ -->
      <div class="section-label"><span class="bar"></span>é€ä¿¡å…ƒãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</div>
      <input id="from-input" type="text" placeholder="ä¾‹: @amazon.co.jp / example@gmail.com">

      <!-- ä»¶å -->
      <div class="section-label"><span class="bar"></span>ä»¶åã«å«ã‚€è¨€è‘‰</div>
      <input id="subject-input" type="text" placeholder="ä¾‹: ã‚»ãƒ¼ãƒ«, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³">

      <!-- æœ¬æ–‡ -->
      <div class="section-label"><span class="bar"></span>æœ¬æ–‡ã«å«ã‚€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</div>
      <input id="body-input" type="text" placeholder="ä¾‹: èªè¨¼ã‚³ãƒ¼ãƒ‰, åºƒå‘Š">

      <!-- é™¤å¤–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ -->
      <div class="section-label"><span class="bar"></span>é™¤å¤–ã—ãŸã„å˜èª</div>
      <input id="exclude-input" type="text" placeholder="ä¾‹: ãƒ¬ã‚·ãƒ¼ãƒˆ, æ³¨æ–‡">

      <!-- æ—¥ä»˜ -->
      <div class="row-two">
        <div>
          <div class="section-label"><span class="bar"></span>ã“ã®æ—¥ã‚ˆã‚Šå¾Œ</div>
          <input id="after-input" type="text" placeholder="ä¾‹: 2023/12/01 ã¾ãŸã¯ 30d">
        </div>
        <div>
          <div class="section-label"><span class="bar"></span>ã“ã®æ—¥ã‚ˆã‚Šå‰</div>
          <input id="before-input" type="text" placeholder="ä¾‹: 2023/01/01 ã¾ãŸã¯ 7d">
        </div>
      </div>

      <!-- è‡ªå‹•ç”Ÿæˆ -->
      <div class="button-row">
        <button id="btn-generate" class="btn-main">
          <span class="icon">âš™ï¸</span>
          æ¡ä»¶ã‚’è‡ªå‹•ã§ä½œã‚‹
        </button>
        <button id="btn-reset" class="btn-ghost">
          ğŸ”„ æ¡ä»¶ãƒªã‚»ãƒƒãƒˆ
        </button>
      </div>

      <div class="section-label"><span class="bar"></span>ç”Ÿæˆã•ã‚ŒãŸæ¤œç´¢æ¡ä»¶</div>
      <textarea id="query-text" rows="3" placeholder="ã“ã“ã« Gmail ã®æ¤œç´¢æ¡ä»¶ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"></textarea>

      <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»å®Ÿè¡Œãƒœã‚¿ãƒ³ -->
      <div class="button-row">
        <button id="btn-preview" class="btn-secondary">
          <span class="icon">ğŸ”</span>
          å¯¾è±¡ãƒ¡ãƒ¼ãƒ«ã‚’ç¢ºèªã™ã‚‹
        </button>
        <button id="btn-execute" class="btn-danger">
          <span class="icon">âš ï¸</span>
          ã“ã®æ¡ä»¶ã§å®Ÿè¡Œã™ã‚‹
        </button>
      </div>

      <!-- å®Ÿè¡Œã‚¿ã‚¤ãƒ—é¸æŠ -->
      <div class="section-label"><span class="bar"></span>å®Ÿè¡Œã™ã‚‹æ“ä½œ</div>
      <select id="action-select">
        <option value="trash">å‰Šé™¤ï¼ˆã‚´ãƒŸç®±ã¸ç§»å‹•ï¼‰</option>
        <option value="archive">å‰Šé™¤ã›ãšå—ä¿¡ãƒˆãƒ¬ã‚¤ã‹ã‚‰éè¡¨ç¤º</option>
        <option value="read">æ—¢èª­ã«ã™ã‚‹</option>
      </select>

    </section>

<a href="//af.moshimo.com/af/c/click?a_id=5296981&p_id=6331&pc_id=17865&pl_id=84085&url=https%3A%2F%2Fwww.conoha.jp%2Fai%2Fcanvas%2Faffsp%2F%3Fbanner_id%3Dd11_media%26utm_source%3Dmoshimo%26utm_medium%3Dmedia%26utm_campaign%3Dothers" rel="nofollow" referrerpolicy="no-referrer-when-downgrade" attributionsrc>
  <img src="https://image.moshimo.com/af-img/1762/000000084085.gif" style="border:none;" alt="">
</a><
      img src="//i.moshimo.com/af/i/impression?a_id=5296981&p_id=6331&pc_id=17865&pl_id=84085" width="1" height="1" style="border:none;" alt="" loading="lazy">
    
    <!-- ============================= -->
    <!-- å³ã‚«ãƒ©ãƒ ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼†çµæœ -->
    <!-- ============================= -->
    <section class="card" aria-label="å®Ÿè¡Œçµæœ">

      <h2 class="section-title right">
        <span class="dot"></span>
        å¯¾è±¡ãƒ¡ãƒ¼ãƒ«ã®ç¢ºèªã¨å®Ÿè¡Œãƒ­ã‚°
      </h2>

      <p class="desc">
        å®Ÿè¡Œã™ã‚‹å‰ã«ã€å¿…ãšã€Œå¯¾è±¡ãƒ¡ãƒ¼ãƒ«ã‚’ç¢ºèªã™ã‚‹ã€ã§ä»¶æ•°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚  
        â€»é€šä¿¡çŠ¶æ³ã«ã‚ˆã£ã¦ã¯ 1ã€œ3 ç§’ã»ã©æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
      </p>

      <div class="result-block">
        <div class="result-header">
          <span class="title">ç¾åœ¨ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</span>
          <span class="counter" id="preview-count-label">å¯¾è±¡ä»¶æ•°: - ä»¶</span>
        </div>
        <textarea id="preview-text" rows="6" placeholder="ã“ã“ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™"></textarea>
      </div>

      <div class="result-block danger">
        <div class="result-header">
          <span class="title">å®Ÿè¡Œçµæœãƒ­ã‚°ï¼ˆGmail API å¿œç­”ï¼‰</span>
          <span class="counter" id="result-count-label">æœ€çµ‚ä»¶æ•°: - ä»¶</span>
        </div>
        <textarea id="result-text" rows="6" placeholder="å®Ÿè¡Œå¾Œã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™"></textarea>
      </div>

      <div class="button-row">
        <button id="btn-clear-result" class="btn-ghost">
          ğŸ§¹ å®Ÿè¡Œçµæœãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢
        </button>
      </div>

    </section>

  </div>
</main>

<section class="seo-article" style="background:#ffffff;border:1px solid #e0e0e0;border-radius:12px;padding:24px;margin-bottom:28px;box-shadow:0 1px 3px rgba(60,64,67,0.18);">

  <h2 style="margin-top:0;font-size:1.4rem;">ğŸ“© Mail Cleaner Labï¼ˆGmail è‡ªå‹•æ•´ç†ãƒ„ãƒ¼ãƒ«ï¼‰ã¨ã¯ï¼Ÿ</h2>

  <p>
    <strong>Mail Cleaner Lab</strong> ã¯ã€Gmail ã«å±Šãå¤§é‡ã®ãƒ¡ãƒ¼ãƒ«ã‚’
    <strong>å®‰å…¨ã«ãƒ»æ­£ç¢ºã«ãƒ»ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§æ•´ç†ã§ãã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«</strong>ã§ã™ã€‚  
    ãƒ–ãƒ©ã‚¦ã‚¶ã ã‘ã§å‹•ä½œã—ã€ã‚¢ãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã€‚  
    Google ã®å…¬å¼ OAuth èªè¨¼ã‚’åˆ©ç”¨ã—ã¦ãŠã‚Šã€ã‚ãªãŸã® Gmail ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã«è§¦ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
  </p>

  <p>
    ç‰¹ã« Gmail ã¯ã€æ—¥ã€…å¤šãã®åºƒå‘Šãƒ»ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ãƒ»ã‚¢ãƒ—ãƒªé€šçŸ¥ãŒå±ŠããŸã‚ã€
    <strong>æ°—ã¥ã„ãŸã‚‰æ•°ä¸‡ä»¶ã®æœªèª­ãƒ¡ãƒ¼ãƒ«ã«ãªã£ã¦ã—ã¾ã†</strong>ã“ã¨ãŒå¤šãã‚ã‚Šã¾ã™ã€‚  
    Mail Cleaner Lab ã¯ã€ãã†ã„ã£ãŸæ‚©ã¿ã‚’ã€Œæ¤œç´¢æ¡ä»¶ã®è‡ªå‹•ç”Ÿæˆ â†’ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ â†’ å®Ÿè¡Œã€ã®æµã‚Œã§ã€
    åˆå¿ƒè€…ã§ã‚‚å®‰å…¨ã«æ•´ç†ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚
  </p>

  <div style="background:#f8f9fa;padding:16px;border-left:4px solid #1a73e8;border-radius:8px;margin:22px 0;">
    <strong>Mail Cleaner Lab ã®ç‰¹å¾´ï¼š</strong><br>
    ãƒ»æ¤œç´¢æ¡ä»¶ã‚’ AI ãŒè‡ªå‹•ã§ç”Ÿæˆ<br>
    ãƒ»å¯¾è±¡ãƒ¡ãƒ¼ãƒ«ã®ä»¶æ•°ã‚’äº‹å‰ã«ç¢ºèªå¯èƒ½ï¼ˆãƒŸã‚¹é˜²æ­¢ï¼‰<br>
    ãƒ»å‰Šé™¤ / ã‚¢ãƒ¼ã‚«ã‚¤ãƒ– / æ—¢èª­åŒ–ã‚’ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å®Ÿè¡Œ<br>
    ãƒ»Gmail API ã®å…¬å¼æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ãŸå®‰å…¨ãªæ“ä½œ<br>
  </div>

  <h2>ğŸ§¹ ã“ã®ãƒ„ãƒ¼ãƒ«ã§ã§ãã‚‹ã“ã¨</h2>
  <ul>
    <li>ğŸ” AI ã‚’ä½¿ã£ãŸ Gmail æ¤œç´¢æ¡ä»¶ã®è‡ªå‹•ç”Ÿæˆ</li>
    <li>ğŸ“Š å¯¾è±¡ãƒ¡ãƒ¼ãƒ«æ•°ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º</li>
    <li>ğŸ—‘ï¸ ä¸è¦ãƒ¡ãƒ¼ãƒ«ã®ä¸€æ‹¬å‰Šé™¤ï¼ˆã‚´ãƒŸç®±ã¸ç§»å‹•ï¼‰</li>
    <li>ğŸ“¦ å¿…è¦ãªãƒ¡ãƒ¼ãƒ«ã ã‘æ®‹ã—ã¤ã¤ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã™ã‚‹</li>
    <li>âœ‰ï¸ å¤§é‡ã®æœªèª­ãƒ¡ãƒ¼ãƒ«ã‚’å³æ™‚ã«æ—¢èª­åŒ–</li>
    <li>ğŸ“± ã‚¹ãƒãƒ›å¯¾å¿œï¼ˆPWAã§ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ å¯èƒ½ï¼‰</li>
  </ul>

  <h2>ğŸ“Œ Gmail ã«ãƒ¡ãƒ¼ãƒ«ãŒæºœã¾ã£ã¦ã—ã¾ã†ä¸»ãªç†ç”±</h2>
  <p>Gmail ã®å—ä¿¡ãƒˆãƒ¬ã‚¤ãŒæ•£ã‚‰ã‹ã‚‹åŸå› ã®å¤šãã¯ä»¥ä¸‹ã® 4 ã¤ã§ã™ï¼š</p>
  <ul>
    <li>åºƒå‘Šãƒ¡ãƒ¼ãƒ«ãƒ»ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é€šçŸ¥ãŒæ¯æ—¥å±Šã</li>
    <li>ã‚¢ãƒ—ãƒªãƒ»SNS ã‹ã‚‰ã®é€šçŸ¥ãŒè‡ªå‹•çš„ã«è“„ç©ã•ã‚Œã‚‹</li>
    <li>ãƒ¡ãƒ«ãƒã‚¬ã®è³¼èª­å¢—åŠ </li>
    <li>å¤ã„ãƒ¡ãƒ¼ãƒ«ã‚’æ•°å¹´é–“æ”¾ç½®ã—ã¦ã—ã¾ã†</li>
  </ul>
  <p>
    ç‰¹ã« <code>older_than:30d</code>ï¼ˆ30æ—¥ã‚ˆã‚Šå‰ï¼‰ã§æ¤œç´¢ã™ã‚‹ã¨ã€  
    <strong>å®Ÿéš›ã«ã¯ 9 å‰²ãŒä¸è¦ãƒ¡ãƒ¼ãƒ«</strong>ã§ã‚ã‚‹ã‚±ãƒ¼ã‚¹ã‚‚çã—ãã‚ã‚Šã¾ã›ã‚“ã€‚
  </p>

  <h2>ğŸ” å®‰å…¨æ€§ã«ã¤ã„ã¦ï¼ˆé‡è¦ï¼‰</h2>
  <p>
    Mail Cleaner Lab ã¯ Google ã®å…¬å¼ OAuth ã‚’åˆ©ç”¨ã—ã€  
    <strong>Gmail ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä¿å­˜ãƒ»å–å¾—ã™ã‚‹ã“ã¨ã¯ä¸€åˆ‡ã‚ã‚Šã¾ã›ã‚“ã€‚</strong>
  </p>

  <ul>
    <li>âœ” ãƒ­ã‚°ã‚¤ãƒ³ã¯ã™ã¹ã¦ Google å…¬å¼ç”»é¢ã§è¡Œã‚ã‚Œã‚‹</li>
    <li>âœ” ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã¯ãƒ–ãƒ©ã‚¦ã‚¶å†…ã ã‘ã«ä¿å­˜</li>
    <li>âœ” ã‚µãƒ¼ãƒãƒ¼ã«æƒ…å ±ã‚’é€ä¿¡ã›ãšãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œ</li>
    <li>âœ” Gmail å…¬å¼ APIï¼ˆgmail.modifyï¼‰ã§å®‰å…¨ã«å‡¦ç†</li>
  </ul>

  <p>
    ã“ã®ä»•çµ„ã¿ã«ã‚ˆã‚Šã€å€‹äººæƒ…å ±ã‚„ãƒ¡ãƒ¼ãƒ«å†…å®¹ãŒå¤–éƒ¨ã«é€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚  
    ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’é‡è¦–ã—ãŸè¨­è¨ˆã«ãªã£ã¦ã„ã¾ã™ã€‚
  </p>

  <h2>ğŸ“˜ å½“ã‚µã‚¤ãƒˆã§å…¬é–‹ã—ã¦ã„ã‚‹ Gmail å½¹ç«‹ã¡ã‚¬ã‚¤ãƒ‰</h2>
  <p>Mail Cleaner Lab ã¨ä½µã›ã¦å½¹ç«‹ã¤è¨˜äº‹ã‚’å…¬é–‹ã—ã¦ã„ã¾ã™ï¼š</p>
  <ul>
    <li><a href="/blog/delete-tips.html">ãƒ»ä¸è¦ãƒ¡ãƒ¼ãƒ«ã‚’å®‰å…¨ã«å‰Šé™¤ã™ã‚‹æ–¹æ³•</a></li>
    <li><a href="/blog/gmail-cleanup-tips.html">ãƒ»Gmail ã‚’ã‚¹ãƒƒã‚­ãƒªæ•´ç†ã™ã‚‹5ã¤ã®ã‚³ãƒ„</a></li>
    <li><a href="/blog/troubles.html">ãƒ»Gmailã®ã‚ˆãã‚ã‚‹æ‚©ã¿10é¸ã¨å¯¾å‡¦æ³•</a></li>
  </ul>

  <p>
    ã™ã¹ã¦åˆå¿ƒè€…ã«ã‚‚åˆ†ã‹ã‚‹ã‚ˆã†ã«ã€åŸå› ãƒ»æ“ä½œæ–¹æ³•ãƒ»æ”¹å–„ç­–ã‚’ä¸å¯§ã«ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚
    AdSense å¯©æŸ»ã§ã‚‚é‡è¦ãªã€Œæœ‰ç›Šã§ç‹¬è‡ªæ€§ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã€ã¨ã—ã¦è©•ä¾¡ã•ã‚Œã‚‹ã‚«ãƒ†ã‚´ãƒªã§ã™ã€‚
  </p>

  <h2>ğŸ“¬ ã¾ã¨ã‚ï¼šMail Cleaner Lab ã§å—ä¿¡ãƒˆãƒ¬ã‚¤ã‚’å¿«é©ã«ä¿ã¤</h2>

  <p>
    Gmail ã®æ•´ç†ã¯  
    <strong>â‘  æ¤œç´¢æ¡ä»¶ã‚’ä½œã‚‹ â†’ â‘¡ ä»¶æ•°ã‚’ç¢ºèª â†’ â‘¢ ä¸€æ‹¬å‡¦ç†</strong>  
    ã® 3 ã‚¹ãƒ†ãƒƒãƒ—ã§åŠ‡çš„ã«åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚
  </p>

  <p>
    Mail Cleaner Lab ã¯ã“ã®æµã‚Œã‚’å®Œå…¨ã«è‡ªå‹•åŒ–ã—ã¦ã„ã‚‹ãŸã‚ã€  
    èª°ã§ã‚‚ç°¡å˜ã«ãƒ¡ãƒ¼ãƒ«ã®æ–­æ¨é›¢ãŒã§ãã¾ã™ã€‚
  </p>

  <p><strong>ä»Šæ—¥ã‹ã‚‰ã‚ãªãŸã® Gmail ã‚’ã€ã‚‚ã£ã¨å¿«é©ã§ã‚¹ãƒˆãƒ¬ã‚¹ã®ãªã„çŠ¶æ…‹ã«ã€‚</strong></p>

</section>



    <footer>
      Mail Cleaner Lab â€“ Gmail è‡ªå‹•æ•´ç†ãƒ„ãƒ¼ãƒ«ï¼ˆautomaker-hub ç‰ˆï¼‰
    </footer>
  </div>

  <!-- ===================== -->
  <!--   JavaScript éƒ¨åˆ†      -->
  <!-- ===================== -->

<script>
/* ================================
   OAuth è¨­å®šï¼ˆãã®ã¾ã¾ï¼‰
================================ */
const CLIENT_ID = "923017588150-th43jikkldliggrt258aqg95hrk2ob73.apps.googleusercontent.com";
const REDIRECT_URI = "https://automaker-hub.github.io/";
const SCOPES = "https://www.googleapis.com/auth/gmail.modify";
const API_BASE = "https://gmail.googleapis.com/gmail/v1/users/me";

const authStatusEl = document.getElementById("auth-status");

function setAuthStatus(connected) {
  if (!authStatusEl) return;
  authStatusEl.innerHTML =
    '<span class="dot ' +
    (connected ? "on" : "off") +
    '" id="auth-dot"></span> ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ' +
    (connected ? "é€£æºæ¸ˆã¿ âœ”" : "æœªé€£æº");
}

function getStoredToken() {
  const token = localStorage.getItem("gmail_token");
  setAuthStatus(!!token);
  return token;
}

function loginWithGoogle() {
  const url =
    "https://accounts.google.com/o/oauth2/v2/auth" +
    "?client_id=" + encodeURIComponent(CLIENT_ID) +
    "&redirect_uri=" + encodeURIComponent(REDIRECT_URI) +
    "&response_type=token" +
    "&scope=" + encodeURIComponent(SCOPES) +
    "&include_granted_scopes=true" +
    "&prompt=consent";

  window.location.href = url;
}

document.getElementById("oauth-btn").addEventListener("click", loginWithGoogle);

document.getElementById("btn-signout").addEventListener("click", () => {
  localStorage.removeItem("gmail_token");
  setAuthStatus(false);
  alert("é€£æºã‚’è§£é™¤ã—ã¾ã—ãŸã€‚ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚Œã¦ã„ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’å‰Šé™¤ã—ã¾ã—ãŸï¼‰");
});

function extractAccessToken() {
  const hash = window.location.hash.substring(1);
  if (hash) {
    const params = new URLSearchParams(hash);
    const token = params.get("access_token");
    if (token) {
      localStorage.setItem("gmail_token", token);
      setAuthStatus(true);
      history.replaceState(null, "", window.location.pathname + window.location.search);
      return;
    }
  }
  getStoredToken();
}
extractAccessToken();

/* ================================
   Gmail API å…±é€š
================================ */
async function gmailRequest(path, options = {}) {
  const token = getStoredToken();
  if (!token) throw new Error("Google ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæœªé€£æºã§ã™");

  const res = await fetch(API_BASE + path, {
    ...options,
    headers: {
      Authorization: "Bearer " + token,
      Accept: "application/json",
      ...(options.headers || {}),
    },
  });

  if (!res.ok) {
    const text = await res.text();
    throw new Error("HTTP " + res.status + " : " + text);
  }
  if (res.status === 204) return {};
  return res.json();
}

/* ================================
   UI éƒ¨åˆ†
================================ */
const queryTextEl = document.getElementById("query-text");
const previewTextEl = document.getElementById("preview-text");
const resultTextEl = document.getElementById("result-text");
const previewCountLabel = document.getElementById("preview-count-label");
const resultCountLabel = document.getElementById("result-count-label");

let currentPresetKey = null;

/* å·¦ã‚«ãƒ©ãƒ ï¼šæ¡ä»¶ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ */
function clearAllConditionInputs() {
  document.getElementById("from-input").value = "";
  document.getElementById("subject-input").value = "";
  document.getElementById("body-input").value = "";
  document.getElementById("exclude-input").value = "";
  document.getElementById("after-input").value = "";
  document.getElementById("before-input").value = "";
}

function resetAll() {
  clearAllConditionInputs();
  currentPresetKey = null;
  updatePresetButtonStyles();
  queryTextEl.value = "";
  previewTextEl.value = "";
  previewCountLabel.textContent = "å¯¾è±¡ä»¶æ•°: - ä»¶";
}
document.getElementById("btn-reset")?.addEventListener("click", resetAll);

/* ãƒ—ãƒªã‚»ãƒƒãƒˆå¼·èª¿ */
function updatePresetButtonStyles() {
  document.querySelectorAll(".preset button").forEach((btn) => {
    const key = btn.getAttribute("data-preset");
    btn.classList.toggle("active", key === currentPresetKey);
  });
}

function buildGmailQuery() {
  const from = document.getElementById("from-input").value.trim();
  const subject = document.getElementById("subject-input").value.trim();
  const body = document.getElementById("body-input").value.trim();
  const exclude = document.getElementById("exclude-input").value.trim();
  const after = document.getElementById("after-input").value.trim();
  const before = document.getElementById("before-input").value.trim();

  const parts = [];
  if (from) parts.push(`from:(${from})`);
  if (subject) parts.push(`subject:(${subject})`);
  if (body) parts.push(`{${body}}`);
  if (exclude) parts.push(`-{${exclude}}`);
  if (after) parts.push(`after:${after}`);
  if (before) parts.push(`before:${before}`);

  return parts.join(" ");
}

/* ãƒ—ãƒªã‚»ãƒƒãƒˆå‡¦ç† */
function applyPreset(key) {
  if (currentPresetKey === key) {
    currentPresetKey = null;
    clearAllConditionInputs();
    queryTextEl.value = "";
    updatePresetButtonStyles();
    return;
  }

  currentPresetKey = key;
  updatePresetButtonStyles();
  clearAllConditionInputs();

  const fromInput = document.getElementById("from-input");
  const subjectInput = document.getElementById("subject-input");
  const bodyInput = document.getElementById("body-input");
  const beforeInput = document.getElementById("before-input");

  if (key === "rakuten") {
    fromInput.value = "@rakuten.co.jp";
    subjectInput.value = "ãƒã‚¤ãƒ³ãƒˆ, ãŠå¾—, ã‚»ãƒ¼ãƒ«";
  } else if (key === "amazon") {
    fromInput.value = "@amazon.co.jp";
    subjectInput.value = "ãŠã™ã™ã‚, ã‚»ãƒ¼ãƒ«, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³";
  } else if (key === "promo") {
    bodyInput.value = "ã‚»ãƒ¼ãƒ«, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³, åºƒå‘Š";
  } else if (key === "magazine") {
    subjectInput.value = "ãƒ¡ãƒ«ãƒã‚¬, newsletter";
  } else if (key === "old-promo") {
    bodyInput.value = "ã‚»ãƒ¼ãƒ«, ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³, åºƒå‘Š";
    beforeInput.value = "30d";
  }

  queryTextEl.value = buildGmailQuery();
}

document.querySelectorAll(".preset button").forEach(btn => {
  btn.addEventListener("click", () => applyPreset(btn.getAttribute("data-preset")));
});

/* æ¤œç´¢æ¡ä»¶ç”Ÿæˆ */
function handleGenerateQuery() {
  const query = buildGmailQuery();
  queryTextEl.value = query;
  if (!query) alert("æ¤œç´¢æ¡ä»¶ãŒç©ºã§ã™ã€‚\nä½•ã‹å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
}
document.getElementById("btn-generate").addEventListener("click", handleGenerateQuery);

/* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
async function handlePreview() {
  const query = queryTextEl.value.trim();
  if (!query) {
    alert("æ¤œç´¢æ¡ä»¶ãŒç©ºã§ã™");
    return;
  }

  previewCountLabel.textContent = "å¯¾è±¡ä»¶æ•°: å–å¾—ä¸­...";
  previewTextEl.value = "Gmail API ã«å•ã„åˆã‚ã›ä¸­ã§ã™...\n";

  try {
    const data = await gmailRequest("/messages?q=" + encodeURIComponent(query) + "&maxResults=50");

    const count = data.resultSizeEstimate ?? (data.messages || []).length;
    previewCountLabel.textContent = "å¯¾è±¡ä»¶æ•°ï¼ˆæ¨å®šï¼‰: " + count + " ä»¶";

    previewTextEl.value =
      "ã€Gmail API ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€‘\n" +
      "æ¤œç´¢æ¡ä»¶: " + query + "\n\n" +
      "resultSizeEstimate: " + count + "\n\n" +
      JSON.stringify(data, null, 2);
  } catch (err) {
    previewCountLabel.textContent = "å¯¾è±¡ä»¶æ•°: å–å¾—å¤±æ•—";
    previewTextEl.value = "ã‚¨ãƒ©ãƒ¼:\n" + err.message;
  }
}
document.getElementById("btn-preview").addEventListener("click", () => handlePreview());

/* å®‰å…¨å¼·åŒ–ãƒãƒ¼ã‚¸ãƒ§ãƒ³ å®Ÿè¡Œå‡¦ç† */
async function handleExecute() {
  const query = queryTextEl.value.trim();
  if (!query) {
    alert("æ¤œç´¢æ¡ä»¶ãŒç©ºã§ã™");
    return;
  }

  /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æœªç¢ºèªã®å ´åˆã®è­¦å‘Š */
  if (previewCountLabel.textContent.includes("å–å¾—ä¸­") || previewCountLabel.textContent.includes("- ä»¶")) {
    const warn = confirm(
      "âš ï¸ã€æ³¨æ„ã€‘ã¾ã ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ç¢ºèªã—ã¦ã„ã¾ã›ã‚“ã€‚\n" +
      "ã“ã®ã¾ã¾å®Ÿè¡Œã™ã‚‹ã¨æ„å›³ã—ãªã„å¤§é‡å‰Šé™¤ãŒèµ·ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\n\n" +
      "ãã‚Œã§ã‚‚æœ¬å½“ã«ç¶šè¡Œã—ã¾ã™ã‹ï¼Ÿ"
    );
    if (!warn) return;
  }

  const action = document.getElementById("action-select").value;
  const actionLabel = {
    trash: "å‰Šé™¤ï¼ˆã‚´ãƒŸç®±ã¸ï¼‰",
    archive: "ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ï¼ˆå—ä¿¡ãƒˆãƒ¬ã‚¤éè¡¨ç¤ºï¼‰",
    read: "æ—¢èª­ã«ã™ã‚‹",
  }[action];

  const ok = confirm(
    "âš ï¸ã€æœ€çµ‚ç¢ºèªã€‘æœ¬å½“ã«ã“ã®æ¡ä»¶ã§å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ\n\n" +
    "ğŸ” æ¤œç´¢æ¡ä»¶: " + query + "\n" +
    "ğŸ“Œ æ“ä½œå†…å®¹: " + actionLabel + "\n\n" +
    "â€» ã“ã®æ“ä½œã¯ Gmail ä¸Šã§å–ã‚Šæ¶ˆã›ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚\n" +
    "å•é¡Œãªã‘ã‚Œã° OK ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚"
  );
  if (!ok) return;

  resultTextEl.value = "=== Gmail API å®Ÿè¡Œé–‹å§‹ ===\n";
  resultCountLabel.textContent = "æœ€çµ‚ä»¶æ•°: å®Ÿè¡Œä¸­...";

  try {
    /* ID å…¨å–å¾— */
    let allIds = [];
    let pageToken = undefined;

    while (true) {
      const data = await gmailRequest(
        "/messages?q=" + encodeURIComponent(query) +
        "&maxResults=500" +
        (pageToken ? "&pageToken=" + pageToken : "")
      );

      const ids = (data.messages || []).map((m) => m.id);
      allIds.push(...ids);

      if (!data.nextPageToken) break;
      pageToken = data.nextPageToken;
    }

    if (allIds.length === 0) {
      resultCountLabel.textContent = "æœ€çµ‚ä»¶æ•°: 0 ä»¶";
      resultTextEl.value += "è©²å½“ãƒ¡ãƒ¼ãƒ« 0 ä»¶\n";
      return;
    }

    /* batchModify */
    const BATCH_SIZE = 1000;
    let processed = 0;

    for (let i = 0; i < allIds.length; i += BATCH_SIZE) {
      const batchIds = allIds.slice(i, i + BATCH_SIZE);

      const body = {
        ids: batchIds,
        addLabelIds: [],
        removeLabelIds: [],
      };

      if (action === "trash") body.addLabelIds.push("TRASH");
      if (action === "archive") body.removeLabelIds.push("INBOX");
      if (action === "read") {
        body.addLabelIds.push("READ");
        body.removeLabelIds.push("UNREAD");
      }

      const res = await gmailRequest("/messages/batchModify", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(body),
      });

      processed += batchIds.length;
      resultTextEl.value += `--- batchModify (${batchIds.length} ä»¶) ---\n${JSON.stringify(res, null, 2)}\n\n`;
    }

    resultCountLabel.textContent = "æœ€çµ‚ä»¶æ•°: " + processed + " ä»¶";
    resultTextEl.value += "=== å®Œäº† ===\nå‡¦ç†ä»¶æ•°: " + processed + " ä»¶\n";
  } catch (err) {
    resultCountLabel.textContent = "æœ€çµ‚ä»¶æ•°: ã‚¨ãƒ©ãƒ¼";
    resultTextEl.value = "ã‚¨ãƒ©ãƒ¼:\n" + err.message;
  }
}
document.getElementById("btn-execute").addEventListener("click", () => handleExecute());

/* çµæœã‚¯ãƒªã‚¢ */
document.getElementById("btn-clear-result").addEventListener("click", () => {
  resultTextEl.value = "";
  resultCountLabel.textContent = "æœ€çµ‚ä»¶æ•°: - ä»¶";
});

/* ================================
   ã‚¹ãƒãƒ›å‘ã‘ãƒœã‚¿ãƒ³æŠ˜ã‚Šè¿”ã—æœ€é©åŒ–
================================ */
function optimizeButtonWrap() {
  document.querySelectorAll("button").forEach(btn => {
    if (btn.textContent.length > 8) {
      btn.style.whiteSpace = "normal";
    }
  });
}
optimizeButtonWrap();
</script>

  </body>
</html>
